from Crypto.Util.number import *
import gmpy2
from flag import flag

def encrypt(plaintext):
    p = getStrongPrime(3072) 
    m = bytes_to_long(plaintext)
    r = getRandomNBitInteger(1024)

    f = getRandomNBitInteger(1024)
    g = getStrongPrime(768)
    h = gmpy2.invert(f, p) * g % p
    c = (r * h + m) % p
    return (h, p, c)

h, p, c = encrypt(flag)
with open("cipher.txt", "w") as f:
    f.write("h = " + str(h) + "\n")
    f.write("p = " + str(p) + "\n")
    f.write("c = " + str(c) + "\n")
'''
h = 4351159576725280143610925229734335318277961046463726819179371597565984875892815510119375179158077194371216229980548322799765694112684330880176048608317384467657339566076945500982439948580105176200995962289562542106329530283149680419279611269742682495243979726150544210881117923455680159411529661865439359486861630656504645706105364698320731017667124887837095594967264286097552208443628718987916402278423191691915004001183882732406417348733021998591880228817565665075046454844003167677951698967489199525297370279511281781773660410054854838794425423898672511420532927056791455298645756097593733108303383963493441977871530209171083508831685630954975684947089222830875628930945606917207385496122847446972579027274430374181305462893065803726620229927945428481581567082881950250003170966218190275832135661589342166057487600412327478744881203931557998266925139214748427359485070955800415769433914810872294096378489994704705089761416
p = 5647393137346977392287037727688236865341787918462634433917692404165207989138920145950305002731786005519043583207713732230763698252867321138723615206978996448553006587065900733212853062012374667572596354958966371119214661302870281896461166734002859386328594709350328571430768797729401972096832397454985297247524335683516405100429969880537571614491497870682562985365521474913611804629937946678534564394945235745484173484348320330478127824908244398288070199827807748313486381337204248740266077769231878896209173083806318150810509920722606957530610861006174554988234075520894396922405685923896159252106107331312150915007906841341590653817102761554120447004238803396012851417107509587031005610171886702089480529337346517056723246707187406284970581897561827638781409221990604023814852700990908741309527419906363376457668041593135219328560103504307164606117912390475494481225536360696324227283229921254256534291646313840517813814289
c = 1578503549679154814922560445827163056444655489032197009998829643420666705185896277127353336459076018568290161613015915157007108670187792202258493839573563725130653856393092750768470744373048962816395891292793904261650709175154457611094064336023542325026680337325856548873602081475332963053365913936097001721641870465878302492003514345065064240871677362686476295865155263355102253220393382569309740618079386005187167418516035277490815466236992510216337421539284859910396538812059404724818582162031181450422558902442674116210740193129914643052144247338039347107026482255505854799142403400081114398314796581354883099859812363631115309724479673768810202462414198143819188912974053153197722229286014040527509429452043224013893711758695587806608376143523452432522924299123863519086035534300289503915202766552168063776023914465357820638218133296603926716865126046565996772490140634331638535704715688105345560218232958145328352377350
'''